name: Mobsfstatic
version: $SERVICE_TAG
description: >
  ALv4 MobSF Static analyzer result fetcher
accepts: android/apk
rejects: empty|metadata/.*

stage: CORE
category: Static Analysis

file_required: true
# Maximum execution time the service has before it's considered to be timed out
timeout: 120
disable_cache: false

# is the service enabled by default
enabled: true

submission_params:
  - default: false
    name: generate_pdf
    type: bool
    value: true
  - default: 'http://192.168.10.78:8000/' #your MOBSF framework IP
    name: framework_url
    type: str
    value: false
  - default: 'fa5e0f4bab4704b9c9d9d691b91ff360d8ab560804bb428e9f269ec7c0b0d331' #your MOBSF framework API KEY
    name: api_key
    type: str
    value: false

docker_config:
  image: ewifly/assemblyline-service-mobsfstatic:$SERVICE_TAG

update_config:
  update_interval_seconds: 3600
  generates_signatures: false
  method: run
  run_options:
    allow_internet_access: true
    image: ewifly/assemblyline-service-mobsfstatic:$SERVICE_TAG